# AI Mobile App

Cross-platform mobile application built with Expo (React Native) and TypeScript.

## Scripts

- `npm run start` – Start the Expo development server (Metro bundler).
- `npm run android` – Build & run on a connected Android device / emulator.
- `npm run ios` – Build & run on iOS simulator (macOS only) or device.
- `npm run web` – Run the app in a web browser.
- `npm run lint` – Lint TypeScript/JavaScript source files.
- `npm run typecheck` – TypeScript type checking without emitting build output.

## Project Structure

```
App.tsx
app.json
babel.config.js
src/
  screens/
    HomeScreen.tsx
    DetailsScreen.tsx
  navigation/
    RootNavigator.tsx
  components/
    CommonButton.tsx
    ScreenContainer.tsx
  config/
    theme.ts
  hooks/
    useAppTheme.ts
  services/
    apiClient.ts
  types/
    navigation.ts
assets/
  .gitkeep
```

## Adding a New Screen

1. Create a new file in `src/screens/` (e.g. `ProfileScreen.tsx`).
2. Add the screen type to `RootStackParamList` in `src/types/navigation.ts`.
3. Import and register the screen in `src/navigation/RootNavigator.tsx` inside the `Stack.Navigator`.
4. Navigate using `navigation.navigate('Profile')` from any screen.

## Theming

Use `useAppTheme()` hook to access colors from `src/config/theme.ts`.

## API Client

`src/services/apiClient.ts` exports an Axios instance. Replace `baseURL` with your backend URL and extend with custom methods.

## Development Proxy & One-Step Reset (Web CORS Bypass)

To view live API data in the browser without CORS errors, run the local reverse proxy:

1. Install dependencies (already added to package.json):

```bash
npm install
```

2. Start the proxy (forwarding to upstream auth + data endpoints):

```bash
npm run proxy
```

3. In a separate terminal, set Expo public env vars to route web requests through the proxy, then start Expo:

```powershell
$env:EXPO_PUBLIC_API_BASE="http://localhost:3001/api/data"
$env:EXPO_PUBLIC_AUTH_BASE="http://localhost:3001/api/auth"
npm start
```

The app (web only) will use `EXPO_PUBLIC_API_BASE` and `EXPO_PUBLIC_AUTH_BASE` instead of the hardcoded upstream URLs. Native (iOS/Android) continues to hit upstream directly.

### One-Step Reset & Start (Recommended)

Use the automated reset script to:

1. Kill lingering processes on ports 3001 / 8081 / 8082.
2. Restart the proxy and wait for health.
3. Set `EXPO_PUBLIC_API_BASE` + `EXPO_PUBLIC_AUTH_BASE`.
4. Launch Expo.

```bash
npm run dev:reset
```

Flags:

```bash
npm run dev:reset -- --web      # start web target
npm run dev:reset -- --clear    # clear Metro cache
npm run dev:reset -- --web --clear
```

Script location: `scripts/reset-dev.ps1`.

### Separate Start (Manual)

1. `npm run proxy`
2. In a second terminal set env vars then `npm start`.

Proxy code: `proxy/server.js` – maps `/api/data` and `/api/auth` to the real backends and injects permissive CORS headers for development.

Health check: visit `http://localhost:3001/health` in the browser.

Disable proxy by omitting the env vars or use plain `npm start`; the app falls back to original URLs.

### Automatic Web Fallback

If you forget to set env vars on web, the clients now fall back to `http://localhost:3001/api/auth` and `http://localhost:3001/api/data` automatically. Make sure the proxy is running (`npm run proxy` or `npm run dev:reset`) or login will fail.

### Legacy Manual Combined Start

You can still run both manually or with the existing concurrent script:

```bash
npm run dev
```

This uses `concurrently` to run `npm run proxy` and `expo start` together.

## Running the App

```bash
npm install
npm run start
```

Then:

- iPhone: Open Expo Go, scan the QR code from the terminal/web.
- Android: Use Expo Go or press `a` in the terminal to launch an emulator.

## Bitbucket Remote Setup (SSH / PuTTY)

1. Generate SSH key (if not existing) using PuTTYgen:
   - Open PuTTYgen > Generate > Save private key.
   - Copy the public key to Bitbucket (Settings > SSH Keys > Add Key).
2. Test connection:
   ```bash
   ssh -T git@bitbucket.org
   ```
3. Add remote after creating repo:
   ```bash
   git remote add origin <YOUR_BITBUCKET_GIT_URL>
   git push -u origin main
   ```

If using App Password:

1. Create App Password in Bitbucket (Personal Settings > App Passwords).
2. Push using HTTPS and enter username + app password when prompted.

## Git Workflow

```bash
git add .
git commit -m "<commit message>"
git push
```

## Lint & Format

```bash
npm run lint
npx prettier . --write
```

## Type Checking

```bash
npm run typecheck
```

## Notes

- Update `app.json` for app metadata, icons, and splash screens.
- Extend theme or add context providers in `App.tsx` as the app grows.

---

Initial setup generated by automated assistant.
